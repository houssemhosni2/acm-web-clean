<!--title-->
<app-page-title *ngIf="!fromSupplier360 && !search" [heading]="'sidebar.list_asset' | translate" [icon]="'pe-7s-search'"
  [account]="''" [status]="-1"></app-page-title>
<div class="main-card mb-3 card">
  <div class="card-body">
    <p-table #dt [responsive]="true" [autoLayout]=true [value]="assetPaginationEntity.resultsAssets"
      (onLazyLoad)="reloadAssetList($event)" [lazy]="true" [lazyLoadOnInit]="false" sortMode="multiple" [totalRecords]="assetPaginationEntity.totalElements"
      [rowsPerPageOptions]="[5,10,20,50,100]" [paginator]="true" [pageLinks]="5" [rows]="10" [columns]="selectedColumns"
      [showCurrentPageReport]="true" [(selection)]="asset" selectionMode="multiple">
      <ng-template pTemplate="header" let-columns>
        <tr>
          <th class="ACM_Customer_Search_void_Col" *ngIf="search">
            <p-tableHeaderCheckbox ></p-tableHeaderCheckbox>
          </th>
          <!-- actions button -->
          <th *ngFor="let col of columns" [pSortableColumn]="col.field" class="text-center">
              <div class="center-elem text-center">
                {{col.header | translate}}
                <p-sortIcon [field]="col.field" class="pl-1"></p-sortIcon>
              </div>
          </th>
          <th style='width: 40px;' *ngIf="!search"></th>
          <th style='width: 40px;' *ngIf="!search"></th>
        </tr>
        <tr>
          <th class="style='width: 40px;'" *ngIf="search">
            <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
          </th>
          <th *ngFor="let col of columns" [ngSwitch]="col.field">
            <input *ngSwitchCase="'codeArticle'" class="form-control placeholder" type="text"
              (input)="dt.filter($event.target.value, col.field, 'contains')">
            <input *ngSwitchCase="'libelle'" class="form-control placeholder" type="text"
              (input)="dt.filter($event.target.value, col.field, 'contains')">
            <input *ngSwitchCase="'description'" class="form-control placeholder" type="text"
              (input)="dt.filter($event.target.value, col.field, 'contains')">
              <div *ngIf="!fromSupplier360 "><input *ngSwitchCase="'supplierName'" class="form-control" type="text"
              (input)="dt.filter($event.target.value, col.field, 'contains')"></div>
            <input *ngSwitchCase="'prixUnitaire'" class="form-control"  type="number" min="0" step="50"
              (input)="dt.filter($event.target.value, col.field, 'contains')">
            <input *ngSwitchCase="'remiseArticle'" class="form-control"  type="number" min="0" step="50"
              (input)="dt.filter($event.target.value, col.field, 'contains')">

              <input *ngSwitchCase="'typeAsset'" class="form-control placeholder" type="text"
              (input)="dt.filter($event.target.value, col.field, 'contains')">
              <input *ngSwitchCase="'categoryAsset'" class="form-control placeholder" type="text"
              (input)="dt.filter($event.target.value, col.field, 'contains')">
              <input *ngSwitchCase="'subCategoryAsset'" class="form-control placeholder" type="text"
              (input)="dt.filter($event.target.value, col.field, 'contains')">

              <input *ngSwitchCase="'insertBy'" class="form-control" type="text"
              (input)="dt.filter($event.target.value, col.field, 'contains')">
            <input *ngSwitchCase="'dateInsertion'" class="form-control ACM-Dashbord-Date-col" type="date"
              (input)="dt.filter($event.target.value, col.field, 'contains')">
          </th>
          <th style='width: 40px;' *ngIf="!search"></th>
          <th style='width: 40px;' *ngIf="!search"></th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-asset let-rowData let-columns="columns">
        <tr [pSelectableRow]="rowData">

          <td *ngIf="search">
            <p-tableCheckbox  [value]="rowData" ></p-tableCheckbox>
          </td>
          <td *ngFor="let col of columns" [ngSwitch]="col.field" class="text-center">

            <div *ngSwitchCase="'codeArticle'">{{rowData[col.field]}}</div>
            <div class="text-left" *ngSwitchCase="'libelle'">{{rowData[col.field]}}</div>
            <div *ngSwitchCase="'description'">{{rowData[col.field]}}</div>
            <div *ngIf="!fromSupplier360 "><div *ngSwitchCase="'supplierName'">{{rowData[col.field]}}</div></div>
            <div class="text-left" *ngSwitchCase="'prixUnitaire'">{{rowData[col.field]| number: this.decimalPlaces:'fr'}}</div>
            <div *ngSwitchCase="'remiseArticle'">{{rowData[col.field]}} %</div>
            <div *ngSwitchCase="'typeAsset'">{{rowData[col.field]}}</div>
            <div *ngSwitchCase="'categoryAsset'">{{rowData[col.field]}}</div>
            <div *ngSwitchCase="'subCategoryAsset'">{{rowData[col.field]}}</div>
            <div *ngSwitchCase="'insertBy'">{{rowData[col.field] }}</div>
            <div *ngSwitchCase="'dateInsertion'">{{rowData[col.field] | date: 'dd/MM/yyyy'}}</div>
        </td>
          <td *ngIf="!sharedService.habilitationButton('UPDATE',currentPath) && !search && !fromSupplier360">
            <button class="btn btn-success" (click)="updateAsset(rowData,'UPDATE')">
                <i class="pe-7s-pen btn-icon-wrapper text-white"></i>
            </button>
        </td>
        <td *ngIf="!sharedService.habilitationButton('ASSET_360',currentPath) && !search && !fromSupplier360">
            <button class="btn btn-warning" (click)="updateAsset(rowData, 'VIEW')">
              <i class="pe-7s-look btn-icon-wrapper text-white"></i>
            </button>
          </td>
        </tr>
      </ng-template>
    </p-table>
    <div class="text-center opacity-6 pt-1 pb-0">
      <b> {{'dashboard.total' | translate}} {{assetPaginationEntity.totalElements}} </b>
    </div>
  </div>
</div>
<div *ngIf="search" class="card-footer py-2 d-flex justify-content-end">
  <button class="mb-1 mx-2 btn btn-outline-danger"
  (click)="closeModale()">{{'button.cancel' | translate}}</button>
  <button class="mb-1 btn btn-primary" *ngIf="mode==='edit'"
          (click)='addAsset(asset)'>{{'button.add' | translate}}</button>
</div>
