<div class="card">
  <div class="card-header d-flex justify-content-between">
    <div class="btn-actions-pane-right ACM-header-right-{{translate.currentLang}}">
     <!--  <button class="d-inline-flex align-items-center btn btn-primary" (click)="addList()">
        <fa-icon class="mx-2" [icon]="library.getIconDefinition('fas', 'plus')"></fa-icon>
        {{'button.add_list' | translate}}
      </button> -->
    </div>
  </div>

  <p-table #dt [responsive]="true" [autoLayout]="true" [value]="filteredSettings" [lazy]="false" [lazyLoadOnInit]="false"
  sortMode="multiple" [rowsPerPageOptions]="[5, 10, 20, 50, 100]" [paginator]="true" [pageLinks]="5" [rows]="10"
  [columns]="selectedColumns">
  <ng-template pTemplate="header" let-columns>
    <tr>
      <th *ngFor="let col of selectedColumns" [pSortableColumn]="col" class="text-center">
        <div class="center-elem text-center">
          {{col.header | translate}}
        </div>
      </th>
      <th style="width: 40px"></th>
      <th style="width: 40px"></th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-rowData>
    <tr [pSelectableRow]="rowData">
      <td>{{ rowData.valueJson.name }}</td>
      <td><select class="form-select">
        <option *ngFor="let child of getChildren(rowData.id)">
          {{ child.valueJson.name }}
        </option>
      </select></td>
      <td>
               <bSwitch [(ngModel)]="rowData.enabled" [switch-size]="'mini'" [switch-animate]="true"
      [switch-off-color]="'danger'" class="px-2 mb-0" [switch-handle-width]="40"  (click)="enableDisableList(rowData)">
    </bSwitch>
      </td>

      <td>
        <button class="btn btn-warning text-white" (click)="editList(rowData)">
              <fa-icon [icon]="library.getIconDefinition('fas', 'pencil-alt')"></fa-icon>
            </button>
      </td>
    </tr>
  </ng-template>
</p-table>
</div>





<ng-template #modalContent let-modal>
  <div>
    <div class="modal-header py-2">
      
      <h5 class="modal-title" *ngIf="!update">
        {{ "setting.new_list" | translate }}
      </h5>
      <h5 class="modal-title" *ngIf="update">
        {{ "setting.modify_list" | translate }}
      </h5>
      <button type="button" class="close ACM-modal-header-{{ translate.currentLang }}" (click)="modal.dismiss()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>

    <div>
      <p-accordion [activeIndex]="[0, 1]" [multiple]="true" class="w-full">
        <p-accordionTab>
          <ng-template pTemplate="header">
            <div class="flex align-items-center">

              <span class="vertical-align-middle">{{
                "setting.list_details" | translate
                }}</span>
            </div>
          </ng-template>
          <ng-template pTemplate="content">
            <form class="form" [formGroup]="settingListForm">
              <div class="position-relative pb-4">
                <div class="row">
                  <div class="col-xl-6 col-md-6 col-md-6 px-1">
                    <label>{{ "setting.name" | translate }}</label>
                    <div formGroupName="valueJson">
                      <input type="text" class="form-control" formControlName="name" disabled/>
                    </div>
                  </div>

                </div>
              </div>
            </form>
          </ng-template>
        </p-accordionTab>
        <p-accordionTab>
          <ng-template pTemplate="header">
            <div class="flex align-items-center">

              <span class="vertical-align-middle">{{  "setting.list_values" | translate }}</span>
            </div>
          </ng-template>
          <ng-template pTemplate="content">
            <div class="btn-actions-pane-right d-flex justify-content-between">
              <button class="d-inline-flex align-items-center btn btn-primary ACM-header-right-{{
                  translate.currentLang
                }}" (click)="addToList()">
                <fa-icon class="mx-2" [icon]="library.getIconDefinition('fas', 'plus')"></fa-icon>
                {{ "button.add_list_values" | translate }}
              </button>
            </div>
            <p-table [value]="updateChildSettingList" [tableStyle]="{ width: '100%' }">
              <ng-template pTemplate="header">
                <tr>
                  <th>{{ 'setting.value' | translate }}</th>
                  <th *ngIf="hasPrimaryField"> {{ 'setting.Primary' | translate }} </th>
                  <th></th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-item let-rowIndex="rowIndex">
                <tr *ngIf="item.enabled">
                  <td>
                    <input type="text" class="form-control" [(ngModel)]="item.valueJson.name" required />
                  </td>
                  <td *ngIf="item.valueJson?.primary !== undefined">
                    <bSwitch 
                      [(ngModel)]="item.valueJson.primary" 
                      [switch-size]="'mini'" 
                      [switch-animate]="true"
                      [switch-off-color]="'danger'" 
                      class="px-2 mb-0" 
                      [switch-handle-width]="40"
                      (ngModelChange)="onPrimaryChange($event, rowIndex)">
                    </bSwitch>
                  </td>
                  <td>
                    <button class="btn btn-danger" (click)="disableItem(rowIndex)">
                      <i class="pe-7s-trash btn-icon-wrapper text-white"></i>
                    </button>
                  </td>
                </tr>
              </ng-template>
            </p-table>
            <div class="modal-footer py-1">
              <button class="mb-2 mx-2 btn btn-outline-danger close" type="button" (click)="reset(); modal.dismiss()">
                {{ "button.cancel" | translate }}
              </button>
              <button (click)="saveUdfGroup()" class="mb-2 btn btn-primary" type="submit">
                {{ "button.save" | translate }}
              </button>
            </div>
          </ng-template>
        </p-accordionTab>
      </p-accordion>
    </div>
  </div>
</ng-template>