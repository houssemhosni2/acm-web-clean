<app-page-title [heading]=" 'sidebar.loan_application'| translate " [icon]="'pe-7s-note2'"
  [account]="loan.accountNumber" [status]="loan.statutWorkflow" [loanApplicationStatus]="loan?.loanApplicationStatus"></app-page-title>
<div class="row">
  <div class="col-md-9 col-xl-9 px-1">


    <app-customer [expanded]="false"></app-customer>
    <app-loan-info [expanded]="true"></app-loan-info>
    <app-list-documents [expanded]="true"></app-list-documents>
    <app-loan-provider-article [mode]="view" [supplier]="loan.productDTO.supplier"> </app-loan-provider-article>
    <div class="accordion mb-1" id="accordionExample">
      <div class="card">
        <!-- <div class="card-header d-flex justify-content-between" id="headingOne" data-target="#collapseUploadDocument"
          aria-expanded="true" aria-controls="collapseUploadDocument" (click)="toggleCollapse()">
          <div>
            <i class="lnr-file-empty text-secondary pr-2"></i>
            {{'upload_document.Upload_document'| translate }}
          </div>
          <div>
            <i [ngClass]="(expanded===true)?'lnr-chevron-up text-secondary':'lnr-chevron-down text-secondary'"></i>
          </div>
        </div> -->
        <div id="collapseUploadDocument" [ngClass]="(expanded===true)?'collapse show':'collapse'"
          aria-labelledby="headingOne">
          <div class="card-body px-2 pt-2">
            <!-- <app-upload-document #childcomp #checkRequired [idloan]="idloan" (toSaveDocuments)="toSave($event)"
              (checkRequiredDoc)="checkRequiredDocumentParent($event)"
              (typeDocumentExist)="typeDocumentExistMethode($event)"></app-upload-document> -->

              <app-upload-item (typeDocumentExist)="typeDocumentExistMethode($event)"  (saveDone)="saveDocumentsDone($event)" [saveFilesAction]="saveFilesAction" (lengthDocuments)="receiveLengthDocuments($event)" [category]="categoryLoan"
              [originSource]="originSource"
              (checkRequiredDoc)="checkRequiredDocumentParent($event)">
            </app-upload-item>
          </div>
        </div>
      </div>
    </div>
    <app-list-documents [expanded]="true"></app-list-documents>
    <app-customer-notes *ngIf="!isOfflineModeEnabled()" [expanded]="true"></app-customer-notes>
    <app-event-table *ngIf="!isOfflineModeEnabled()" [expanded]="true" [source]="'LOAN'"></app-event-table>
    <app-charge-fee-step [expanded]="true" [source]="'LOAN'"></app-charge-fee-step>
    <div *ngIf="loan.etapeWorkflow > 23" >
    <app-conditional-approve-list *ngIf="!isOfflineModeEnabled()" [expanded]="true" ></app-conditional-approve-list>
    </div>
     <app-udf-step-workflow [source]="'workflow'" [category]="'LOAN'"></app-udf-step-workflow>
    <div class=" d-block text-end pt-2">
      <button class="mb-2 mx-2 btn btn-outline-danger" (click)="exit()">{{'button.exit' | translate}}</button>
      <button class="mb-2 mx-2 btn btn-secondary text-white" *ngIf="loan.parentId === 0"
        (click)="previousStep()">{{'button.previous' | translate}}</button>
      <!-- Child Loan Review -->
      <button class="mb-2 mx-2 btn btn-secondary text-white"
        *ngIf="((loan.parentId !== 0) && (loan.etapeWorkflow === 16))"
        (click)="previousStep()">{{'button.previous' | translate}}</button>
      <button *ngIf="( !loanSharedService.habilitationButton('SAVE',currentPath) && loan.isOwnerOrValidator)" class="mb-2 mx-2 btn btn-success text-white"
        (click)="onsave()" >{{'button.save' | translate}}</button>
      <button class="mb-2 btn btn-primary" (click)="nextStep()"
        *ngIf="(!loanSharedService.habilitationButton('NEXT',currentPath) && loan.parentId === 0) && loan.isOwnerOrValidator">{{'button.next' | translate}}</button>
      <!-- Child Loan Review -->
      <button class="mb-2 btn btn-primary" (click)="nextStep()" [disabled]=" loanSharedService.getAuthorized()"
        *ngIf="((loan.parentId !== 0) && (loan.etapeWorkflow === 16))">{{'button.next' | translate}}</button>
        <button class="mb-2 mx-2 btn btn-primary "
        *ngIf=" displayButtonExecuteApi && (!loanSharedService.habilitationButton('EXECUTE_API',currentPath) && loan.isOwnerOrValidator) && !isOfflineModeEnabled()"
        type="submit" (click)="executeThirdPartyApi()" >{{('Execute_api'|translate)}} </button>


    </div>
  </div>

  <div class="col-md-3 col-xl-3 px-1">
    <app-loan-process [etapeProcess]="currentStatus"></app-loan-process>
  </div>
</div>
